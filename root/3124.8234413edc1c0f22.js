"use strict";(self.webpackChunkapp=self.webpackChunkapp||[]).push([[3124],{3124:(W,v,d)=>{d.r(v),d.d(v,{HomePageModule:()=>N});var g=d(1368),l=d(4716),s=d(2112),h=d(4196),u=d(1528),e=d(4496),y=d(9208),P=d(7284),C=d(5088),I=d(9744);function R(o,r){if(1&o&&(e.I0R(0,"ion-avatar"),e.wR5(1,"img",11),e.C$Y()),2&o){const i=e.GaO();e.yG2(),e.E7m("src",i.form.value.image,e.K6U)}}function U(o,r){1&o&&e.wR5(0,"ion-icon",12)}function $(o,r){1&o&&(e.I0R(0,"div"),e.OEk(1,"This field is required"),e.C$Y())}function Y(o,r){1&o&&(e.I0R(0,"div"),e.OEk(1,"name required at least 4 characters"),e.C$Y())}function b(o,r){if(1&o&&(e.I0R(0,"div",13),e.yuY(1,$,2,0,"div",2)(2,Y,2,0,"div",2),e.C$Y()),2&o){const i=e.GaO();e.yG2(),e.E7m("ngIf",null==i.form.controls.name.errors?null:i.form.controls.name.errors.required),e.yG2(),e.E7m("ngIf",null==i.form.controls.name.errors?null:i.form.controls.name.errors.minlength)}}function E(o,r){1&o&&(e.I0R(0,"div"),e.OEk(1,"This field is required"),e.C$Y())}function G(o,r){1&o&&(e.I0R(0,"div"),e.OEk(1,"Minimum price must be 0"),e.C$Y())}function S(o,r){if(1&o&&(e.I0R(0,"div",13),e.yuY(1,E,2,0,"div",2)(2,G,2,0,"div",2),e.C$Y()),2&o){const i=e.GaO();e.yG2(),e.E7m("ngIf",null==i.form.controls.price.errors?null:i.form.controls.price.errors.required),e.yG2(),e.E7m("ngIf",null==i.form.controls.price.errors?null:i.form.controls.price.errors.min)}}function k(o,r){1&o&&(e.I0R(0,"div"),e.OEk(1,"This field is required"),e.C$Y())}function T(o,r){1&o&&(e.I0R(0,"div"),e.OEk(1,"Minimum amount must be 0"),e.C$Y())}function O(o,r){if(1&o&&(e.I0R(0,"div",13),e.yuY(1,k,2,0,"div",2)(2,T,2,0,"div",2),e.C$Y()),2&o){const i=e.GaO();e.yG2(),e.E7m("ngIf",null==i.form.controls.soldUnits.errors?null:i.form.controls.soldUnits.errors.required),e.yG2(),e.E7m("ngIf",null==i.form.controls.soldUnits.errors?null:i.form.controls.soldUnits.errors.min)}}let A=(()=>{var o;class r{constructor(){this.form=new l.WC({id:new l.Ku(""),image:new l.Ku("",[l.AQ.required]),name:new l.Ku("",[l.AQ.required,l.AQ.minLength(4)]),price:new l.Ku(null,[l.AQ.required,l.AQ.min(0)]),soldUnits:new l.Ku(null,[l.AQ.required,l.AQ.min(0)])}),this.firebaseSvc=(0,e.uUt)(y.C),this.utilsSvc=(0,e.uUt)(P.e),this.user={}}ngOnInit(){this.user=this.utilsSvc.getFromLocalStorage("user"),this.product&&this.form.setValue(this.product)}takeImage(){var t=this;return(0,u.c)(function*(){const n=(yield t.utilsSvc.takePicture("Product Image")).dataUrl;t.form.controls.image.setValue(n),console.log(n)})()}submit(){var t=this;return(0,u.c)(function*(){t.form.valid&&(t.product?t.updateProduct():t.createProduct())})()}setNumberInputs(){let{soldUnits:t,price:n}=this.form.controls;t.value&&t.setValue(parseFloat(t.value)),n.value&&n.setValue(parseFloat(n.value))}createProduct(){var t=this;return(0,u.c)(function*(){console.log(t.user.uid);let n=`users/${t.user.uid}/products`;const c=yield t.utilsSvc.loading();yield c.present();let a=t.form.value.image,p=`${t.user.uid}/${Date.now()}`,m=yield t.firebaseSvc.uploadImage(p,a);t.form.controls.image.setValue(m),delete t.form.value.id,t.firebaseSvc.addDocument(n,t.form.value).then(function(){var f=(0,u.c)(function*(_){t.utilsSvc.dismissModal({success:!0}),console.log(_),t.utilsSvc.presentToast({message:"Product created",duration:1500,color:"success",position:"middle",icon:"checkmark-circle-outline"})});return function(_){return f.apply(this,arguments)}}()).catch(f=>{console.log(f),t.utilsSvc.presentToast({message:f.message,duration:2500,color:"primary",position:"middle",icon:"alert-circle-outline"})}).finally(()=>{c.dismiss()})})()}updateProduct(){var t=this;return(0,u.c)(function*(){console.log(t.user.uid);let n=`users/${t.user.uid}/products/${t.product.id}`;const c=yield t.utilsSvc.loading();if(yield c.present(),t.form.value.image!==t.product.image){let a=t.form.value.image,p=yield t.firebaseSvc.getFilePath(t.product.image),m=yield t.firebaseSvc.uploadImage(p,a);t.form.controls.image.setValue(m),console.log(m)}delete t.form.value.id,t.firebaseSvc.updateDoc(n,t.form.value).then(function(){var a=(0,u.c)(function*(p){t.utilsSvc.dismissModal({success:!0}),console.log(p),t.utilsSvc.presentToast({message:"Product updated",duration:1500,color:"success",position:"middle",icon:"checkmark-circle-outline"})});return function(p){return a.apply(this,arguments)}}()).catch(a=>{console.log(a),t.utilsSvc.presentToast({message:a.message,duration:2500,color:"primary",position:"middle",icon:"alert-circle-outline"})}).finally(()=>{c.dismiss()})})()}}return(o=r).\u0275fac=function(t){return new(t||o)},o.\u0275cmp=e.In1({type:o,selectors:[["app-add-update-product"]],inputs:{product:"product"},decls:16,vars:13,consts:[[3,"isModal","title"],[1,"ion-padding","ion-text-center",3,"formGroup","ngSubmit","keypress.enter"],[4,"ngIf"],["class"," ","name","image-outline",4,"ngIf"],["mode","ios","size","small","shape","round",3,"click"],["autocomplete","name","type","text","label","name",3,"control"],["class","validators",4,"ngIf"],["type","number","label","price",3,"control","ionInput"],["type","number","label","Sold Units",3,"control","ionInput"],["mode","ios","type","submit",1,"ion-margin",3,"disabled"],["slot","end","name","checkmark-circle-outline"],[3,"src"],["name","image-outline",1,""],[1,"validators"]],template:function(t,n){1&t&&(e.wR5(0,"app-header",0),e.I0R(1,"ion-content")(2,"form",1),e.qCj("ngSubmit",function(){return n.submit()})("keypress.enter",function(){return n.submit()}),e.yuY(3,R,2,1,"ion-avatar",2)(4,U,1,0,"ion-icon",3),e.I0R(5,"ion-button",4),e.qCj("click",function(){return n.takeImage()}),e.OEk(6," Take/Select "),e.C$Y(),e.wR5(7,"app-custom-input",5),e.yuY(8,b,3,2,"div",6),e.I0R(9,"app-custom-input",7),e.qCj("ionInput",function(){return n.setNumberInputs()}),e.C$Y(),e.yuY(10,S,3,2,"div",6),e.I0R(11,"app-custom-input",8),e.qCj("ionInput",function(){return n.setNumberInputs()}),e.C$Y(),e.yuY(12,O,3,2,"div",6),e.I0R(13,"ion-button",9),e.OEk(14),e.wR5(15,"ion-icon",10),e.C$Y()()()),2&t&&(e.E7m("isModal",!0)("title",n.product?"Update Product":"Add Product"),e.yG2(2),e.E7m("formGroup",n.form),e.yG2(),e.E7m("ngIf",n.form.value.image),e.yG2(),e.E7m("ngIf",!n.form.value.image),e.yG2(3),e.E7m("control",n.form.controls.name),e.yG2(),e.E7m("ngIf",n.form.controls.name.errors&&n.form.controls.name.touched),e.yG2(),e.E7m("control",n.form.controls.price),e.yG2(),e.E7m("ngIf",n.form.controls.price.errors&&n.form.controls.price.touched),e.yG2(),e.E7m("control",n.form.controls.soldUnits),e.yG2(),e.E7m("ngIf",n.form.controls.soldUnits.errors&&n.form.controls.soldUnits.touched),e.yG2(),e.E7m("disabled",n.form.invalid),e.yG2(),e.oRS(" ",n.product?"Update Product":"Add Product"," "))},dependencies:[g.u_,s.O7,s.sn,s._i,s.Ko,l.sz,l.u,l.uW,C.k,I.y],styles:[".image-icon[_ngcontent-%COMP%]{font-size:100px;opacity:30%}ion-avatar[_ngcontent-%COMP%]{width:200px;height:160px;--border-radius: 15px;margin:0 auto}"]}),r})();var w=d(872);function x(o,r){if(1&o&&(e.I0R(0,"ion-card",8)(1,"div")(2,"h5"),e.OEk(3),e.C$Y(),e.I0R(4,"p"),e.OEk(5,"Products"),e.C$Y()(),e.I0R(6,"div")(7,"h5"),e.OEk(8),e.wVc(9,"currency"),e.C$Y(),e.I0R(10,"p"),e.OEk(11,"Profits"),e.C$Y()()()),2&o){const i=e.GaO();e.yG2(3),e.cNF(i.products.length),e.yG2(5),e.cNF(e.g7$(9,2,i.getProfits(),"USD"))}}function H(o,r){if(1&o){const i=e.KQA();e.I0R(0,"ion-item-sliding",10)(1,"ion-item")(2,"ion-avatar"),e.wR5(3,"img",11),e.C$Y(),e.I0R(4,"ion-label")(5,"div",12),e.OEk(6),e.C$Y(),e.I0R(7,"div",13)(8,"strong"),e.OEk(9,"Price"),e.C$Y(),e.OEk(10),e.wVc(11,"currency"),e.wR5(12,"br"),e.I0R(13,"strong"),e.OEk(14,"Sold Units"),e.C$Y(),e.OEk(15),e.C$Y(),e.I0R(16,"ion-chip",14)(17,"ion-label"),e.OEk(18),e.wVc(19,"currency"),e.C$Y(),e.wR5(20,"ion-icon",15),e.C$Y()()(),e.I0R(21,"ion-item-options")(22,"ion-item-option",6),e.qCj("click",function(){const c=e.usT(i).$implicit,a=e.GaO(2);return e.CGJ(a.addUpdateProduct(c))}),e.wR5(23,"ion-icon",16),e.C$Y(),e.I0R(24,"ion-item-option",17),e.qCj("click",function(){const c=e.usT(i).$implicit,a=e.GaO(2);return e.CGJ(a.confirmDeleteProduct(c))}),e.wR5(25,"ion-icon",18),e.C$Y()()()}if(2&o){const i=r.$implicit;e.yG2(3),e.E7m("src",i.image,e.K6U),e.yG2(3),e.cNF(i.name),e.yG2(4),e.oRS(" ",e.g7$(11,5,i.price,"USD")," "),e.yG2(5),e.oRS(" ",i.soldUnits," "),e.yG2(3),e.oRS("Profit: ",e.g7$(19,8,i.price*i.soldUnits,"USD")," ")}}function M(o,r){if(1&o&&(e.I0R(0,"ion-list"),e.yuY(1,H,26,11,"ion-item-sliding",9),e.C$Y()),2&o){const i=e.GaO();e.yG2(),e.E7m("ngForOf",i.products)}}function F(o,r){1&o&&(e.I0R(0,"ion-item",10)(1,"ion-avatar"),e.wR5(2,"ion-skeleton-text",19),e.C$Y(),e.I0R(3,"ion-label")(4,"div"),e.wR5(5,"ion-skeleton-text",20),e.C$Y(),e.I0R(6,"div"),e.wR5(7,"ion-skeleton-text",21),e.C$Y()()())}const q=()=>[1,1,1,1,1,1,1,1];function D(o,r){1&o&&(e.I0R(0,"ion-list"),e.yuY(1,F,8,0,"ion-item",9),e.C$Y()),2&o&&(e.yG2(),e.E7m("ngForOf",e.q4q(1,q)))}function K(o,r){1&o&&(e.I0R(0,"div",22),e.wR5(1,"ion-icon",23),e.I0R(2,"h3"),e.OEk(3,"Not available products"),e.C$Y()())}const Q=[{path:"",component:(()=>{var o;class r{constructor(){this.firebaseSvc=(0,e.uUt)(y.C),this.utilSvc=(0,e.uUt)(P.e),this.products=[],this.loading=!1}ngOnInit(){}user(){return this.utilSvc.getFromLocalStorage("user")}ionViewWillEnter(){this.getProducts()}doRefresh(t){setTimeout(()=>{this.getProducts(),t.target.complete()},2e3)}getProfits(){return this.products.reduce((t,n)=>t+n.price*n.soldUnits,0)}getProducts(){let t=`users/${this.user().uid}/products`;this.loading=!0;let n=[(0,w.k$)("soldUnits","desc")],c=this.firebaseSvc.getCollectionData(t,n).subscribe({next:a=>{this.products=a,this.loading=!1,c.unsubscribe()}})}addUpdateProduct(t){var n=this;return(0,u.c)(function*(){(yield n.utilSvc.presentModal({component:A,cssClass:"add-update-modal",componentProps:{product:t}}))&&n.getProducts()})()}confirmDeleteProduct(t){var n=this;return(0,u.c)(function*(){n.utilSvc.presentAlert({header:"Delete product",message:"Want to delete this product?",mode:"ios",buttons:[{text:"Cancel"},{text:"Yes, delete",handler:()=>{n.deleteProduct(t)}}]})})()}deleteProduct(t){var n=this;return(0,u.c)(function*(){let c=`users/${n.user().uid}/products/${t.id}`;const a=yield n.utilSvc.loading();yield a.present();let p=yield n.firebaseSvc.getFilePath(t.image);yield n.firebaseSvc.deleteFile(p),n.firebaseSvc.deleteDoc(c).then(function(){var m=(0,u.c)(function*(f){n.products=n.products.filter(_=>_.id!==t.id),n.utilSvc.presentToast({message:"Product deleted",duration:1500,color:"success",position:"middle",icon:"checkmark-circle-outline"})});return function(f){return m.apply(this,arguments)}}()).catch(m=>{console.log(m),n.utilSvc.presentToast({message:m.message,duration:2500,color:"primary",position:"middle",icon:"alert-circle-outline"})}).finally(()=>{a.dismiss()})})()}}return(o=r).\u0275fac=function(t){return new(t||o)},o.\u0275cmp=e.In1({type:o,selectors:[["app-home"]],decls:11,vars:5,consts:[["title","Start",3,"showMenu"],["slot","fixed",3,"ionRefresh"],["mode","ios","color","secondary","class","d-flex-center ion-text-center",4,"ngIf"],[4,"ngIf"],["class","empty",4,"ngIf"],["vertical"," bottom","horizontal","end","slot","fixed"],[3,"click"],["name","add"],["mode","ios","color","secondary",1,"d-flex-center","ion-text-center"],["class","product-item",4,"ngFor","ngForOf"],[1,"product-item"],[3,"src"],[1,"name"],[1,"data"],["color","primary","mode","ios","outline","true"],["name","close-circle"],["name","create-outline",1,"option-btn"],["color","danger",3,"click"],["name","trash-outline",1,"option-btn"],["animated","",2,"width","100%","height","100%"],["animated","",2,"width","50%"],["animated","",2,"width","30%"],[1,"empty"],["name","shield-outline"]],template:function(t,n){1&t&&(e.wR5(0,"app-header",0),e.I0R(1,"ion-content")(2,"ion-refresher",1),e.qCj("ionRefresh",function(a){return n.doRefresh(a)}),e.wR5(3,"ion-refresher-content"),e.C$Y(),e.yuY(4,x,12,5,"ion-card",2)(5,M,2,1,"ion-list",3)(6,D,2,2,"ion-list",3)(7,K,4,0,"div",4),e.I0R(8,"ion-fab",5)(9,"ion-fab-button",6),e.qCj("click",function(){return n.addUpdateProduct()}),e.wR5(10,"ion-icon",7),e.C$Y()()()),2&t&&(e.E7m("showMenu",!0),e.yG2(4),e.E7m("ngIf",!n.loading&&n.products.length),e.yG2(),e.E7m("ngIf",!n.loading),e.yG2(),e.E7m("ngIf",n.loading),e.yG2(),e.E7m("ngIf",!n.loading&&!n.products.length))},dependencies:[g.ay,g.u_,s.O7,s.KC,s.cz,s._i,s.q8,s.Wq,s.Ko,s.Yb,s.uW,s.gf,s.UB,s.QR,s.OC,s._I,s.Wi,s.iI,C.k,g.cf],styles:["ion-card[_ngcontent-%COMP%]{gap:100px;padding:20px 0;border-radius:15px}ion-content[_ngcontent-%COMP%]{padding-bottom:70px}"]}),r})()}];let j=(()=>{var o;class r{}return(o=r).\u0275fac=function(t){return new(t||o)},o.\u0275mod=e.a4G({type:o}),o.\u0275inj=e.s3X({imports:[h.qQ.forChild(Q),h.qQ]}),r})();var V=d(1455);let N=(()=>{var o;class r{}return(o=r).\u0275fac=function(t){return new(t||o)},o.\u0275mod=e.a4G({type:o}),o.\u0275inj=e.s3X({imports:[g.MD,l.y,s.wZ,j,V.k]}),r})()}}]);